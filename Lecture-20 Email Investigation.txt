
#----------------------------------------Email Investigation--------------------------------------#

Email Identities and Data:-
------------------------------------------
The primary evidence in email investigations is the email header. The email header contains a considerable amount of information about the email. Email header analysis should start from bottom to top, because the bottom-most information is the information from the sender, and the top-most information is about the receiver. 


Identify Email in Evidence File:- https://hashes.com/en/emails/extract


#-------------------------------------------------------------------------------####-------------------------------------------------------------------------------#


Email Forensic Investigation Techniques:-
------------------------------------------------------------
Email forensics refers to analyzing the source and content of emails as evidence. Investigation of email related crimes and incidents involves various approaches.

Header Analysis:-
---------------------------
Email header analysis is the primary analytical technique. This involves analyzing metadata in the email header. It is evident that analyzing headers helps to identify the majority of email-related crimes. Email spoofing, phishing, spam, scams and even internal data leakages can be identified by analyzing the header.

Server Investigation:-
---------------------------------
This involves investigating copies of delivered emails and server logs. In some organizations they do provide separate email boxes for their employees by having internal mail servers. In this case, investigation involves the extraction of the entire email box related to the case and the server logs.

Network Device Investigation:-
----------------------------------------------
In some investigations, the investigator requires the logs maintained by the network devices such as routers, firewalls and switches to investigate the source of an email message.  This is often a complex situation where the primary evidence is not percent (when the ISP or proxy does not maintain logs or lacks operation by ISP).

Software Embedded Analysis:-
----------------------------------------------
Some information about the sender of the email, attached files or documents may be included with the message by the email software used by the sender for composing the email. This information may be included in the form of custom headers or in the form of MIME content as a Transport Neutral Encapsulation Format (TNEF).

Sender Mail Fingerprints:-
---------------------------------------
The “Received” field includes tracking information generated by mail servers that have previously handled a message, in reverse order. The “X-Mailer” or “User-Agent” field helps to identify email software. Analyzing these fields helps to understand the software, and the version used by the sender.

Use of Email Trackers:-
----------------------------------
In some situations, attackers use different techniques and locations to generate emails. In such situations it is important to find out the geographical location of the attacker. To get the exact location of the attacker, investigators often use email tracking software embedded into the body of an email. When a recipient opens a message that has an email tracker attached, the investigator will be notified with the IP address and geographical location of the recipient. This technique is often used to identify suspects in murder or kidnapping cases, where the criminal communicates via email.

Volatile Memory Analysis:-
----------------------------------------
Recent research has been conducted in analyzing spoofed mails from volatile memory. Since everything passes through volatile memory, it is possible to extract email related evidence (header information) from volatile memory.

Attachment Analysis:-
----------------------------------
Most viruses and malware are sent through email attachments. Investigating attachments is crucial in any email-related investigation. Confidential information leakage is another important field of investigation. There are software tools available to recover email-related data, such as attachments from computer hard discs. For the analysis of suspicious attachments, investigators can upload documents into an online sandbox such as VirusTotal to check whether the file is malware or not. However, it is important to bear in mind that even if a file passes a test such as VirusTotal’s, this is not a guarantee that it is fully safe. If this happens, it is a good idea to investigate the file further in a sandbox environment such as Cuckoo.


#-------------------------------------------------------------------------------####-------------------------------------------------------------------------------#


Online Header Analysis & Email Trace tools:-
----------------------------------------------------------------
Link:- https://toolbox.googleapps.com/apps/messageheader/
Link:- https://www.iplocation.net/trace-email
Link:- https://www.iptrackeronline.com/email-header-analysis.php
Link:- https://whatismyipaddress.com/trace-email
Link:- https://my-addr.com/trace_email_address/free_email_trace_route/online_email_trace_route_tool.php


#-------------------------------------------------------------------------------####-------------------------------------------------------------------------------#


Email Authentication:-
-----------------------------------
Email authentication is a technical solution to proving that an email is not forged. In other words, it provides a way to verify that an email comes from who it claims to be from. Email authentication is most often used to block harmful or fraudulent uses of email such as phishing and spam.

The most commonly used email authentication standards are SPF, DKIM, and DMARC. These standards were designed to supplement SMTP, the basic protocol used to send email, because SMTP does not itself include any authentication mechanisms.


How does email authentication work?
--------------------------------------------------------
There are several different approaches to email authentication, each with its own advantages and disadvantages. Although the specific technical implementation varies from approach to approach, in general, the process works something like this:-

-->A business or organization that sends email establishes a policy that defines the rules by which email from its domain name can be authenticated.
-->The email sender configures its mail servers and other technical infrastructure to implement and publish these rules.
-->A mail server that receives email authenticates the messages it receives by checking details about an incoming email message against the rules defined by the domain owner.
-->The receiving mail server acts upon the results of this authentication to deliver, flag, or even reject the message.


#-------------------------------------------------------------------------------####-------------------------------------------------------------------------------#


Email Authentication Standards:-
--------------------------------------------------
SPF, DKIM, and DMARC are all standards that enable different aspects of email authentication. They address complementary issues.

SPF:-
----------
The Sender Policy Framework (SPF), is a technical standard and email authentication technique that helps protect email senders and recipients from spam, spoofing, and phishing.
SPF allows senders to define which IP addresses are allowed to send mail for a particular domain.

Link:- https://www.sparkpost.com/resources/email-explained/spf-sender-policy-framework/

DKIM:-
------------
DomainKeys Identified Mail, or DKIM, is a technical standard that helps protect email senders and recipients from spam, spoofing, and phishing.  It is a form of email authentication that allows an organization to claim responsibility for a message in a way that can be validated by the recipient.
DKIM provides an encryption key and digital signature that verifies that an email message was not faked or altered.

Link:- https://www.sparkpost.com/resources/email-explained/dkim-domainkeys-identified-mail/

DMARC:-
---------------
Domain-based Message Authentication, Reporting, and Conformance, or DMARC, is a technical standard that helps protect email senders and recipients from spam, spoofing, and phishing. DMARC allows an organization to publish a policy that defines its email authentication practices and provides instructions to receiving mail servers for how to enforce them.
DMARC unifies the SPF and DKIM authentication mechanisms into a common framework and allows domain owners to declare how they would like email from that domain to be handled if it fails an authorization test.

Link:- https://www.sparkpost.com/resources/email-explained/dmarc-explained/

SPF Checker:-
-----------------------
Link:- https://tools.sparkpost.com/spf/inspector

Link:- https://www.sparkpost.com/blog/understanding-spf-and-dkim/#:~:text=SPF%20is%20a%20form%20of%20email%20authentication%20that,with%20SPF%20protocols.%20DomainKeys%20Identified%20Mail%20(DKIM)%20Definition:


#-------------------------------------------------------------------------------####-------------------------------------------------------------------------------#


Finding Email Headers:-
-------------------------------------
1. Applications
	Apple Mail 2.x
	Microsoft Outlook 2003
	Mozilla Thunderbird 2.x

2. Websites
	Google Mail (GMail)
	Windows Live Hotmail
	Yahoo Mail


Apple Mail 2.x (Mac):-
----------------------------------
-->Select the message you want to view the headers of.
-->Press SHIFT-COMMAND-H to toggle full headers for the message. (Alternatively you can click VIEW in the menu bar, click MESSAGE, click LONG HEADERS.

Microsoft Outlook 2003 (Win):-
----------------------------------------------
-->Select the message you want to view the headers of.
-->Right click the mouse, select OPTIONS
-->Headers will be displayed within the “Internet Headers” area of a pop-up window.

Mozilla Thunderbird 2.x (Win):-
----------------------------------------------
-->Select the message you want to view the headers of.
-->Press CTRL-U (or click VIEW from the menu bar, select MESSAGE SOURCE)
-->Headers will be displayed in a new window.

Google Mail (GMail):-
--------------------------------
-->Open the message you want to view the headers of.
-->Click the down arrow next to the “Reply” link.
-->Select “Show Original” to open a new window with the full headers

Windows Live Hotmail (Full Version):-
------------------------------------------------------

-->This does not work with Safari on Mac OS X
-->Right click on the message. (From the list of emails)
-->Select “View Source”
-->A new window with the full headers and HTML source of the email will open

Yahoo Mail (“New” Version):-
------------------------------------------

-->Right click on the message.
-->Select “View Full Headers”
-->A new window with the full headers will open

Yahoo Mail (“Classic” Version):-
----------------------------------------------

-->Click on the message.
-->Click “Full Headers” on the bottom right of the screen



#-------------------------------------------------------------------------------####-------------------------------------------------------------------------------#


Online IP Information & Location:-
---------------------------------------------------
Link:- https://www.opentracker.net/feature/ip-tracker


Tool:-
Mail Examiner:-
------------------------
E-Mail Examiner offers a performance with speed yet accuracy, and is a proven, easy-to-operate email examiner program.
Link:- https://www.mailxaminer.com/download.html

For Learning:- https://sites.google.com/site/traceemailanalyzer/


#-------------------------------------------------------------------------------####-------------------------------------------------------------------------------#


Reference:- https://www.forensicfocus.com/articles/email-forensics-investigation-techniques/